<!DOCTYPE html>
<!-- saved from url=(0052)http://localhost:31480/session/file30dd47fd1b9a.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8">

  
    <link rel="stylesheet" href="http://timelyportfolio.github.io/rCharts_d3_sankey/css/sankey.css">
    
    <script src="./sankey_complete_files/d3.v3.js" type="text/javascript"></script>
    <script src="./sankey_complete_files/sankey.js" type="text/javascript"></script>
    
    <style>
    .rChart {
      display: block;
      margin-left: auto; 
      margin-right: auto;
      width: 960px;
      height: 600px;
    }  
    </style>
    
  </head>
  <body>
    <div id="chart30dd7aa0a243" class="rChart rCharts_d3_sankey"><svg width="960" height="600"><g><path class="link" d="M15,179.9280207917714C165,179.9280207917714 165,169.92802079177136 315,169.92802079177136" style="stroke-width: 319.84328172390104px;"><title>New Down → Run on 1st Down
55</title></path><path class="link" d="M15,469.924830826861C165,469.924830826861 165,469.9248308268609 315,469.9248308268609" style="stroke-width: 260.15033834627815px;"><title>New Down → Pass on 1st Down
45</title></path><path class="link" d="M645,235.5584158574256C795,235.5584158574256 795,70.88682024497739 945,70.88682024497739" style="stroke-width: 141.7736404899546px;"><title>Pass on 2nd Down → Pass on 3rd Down
24</title></path><path class="link" d="M330,80.20880770311531C480,80.20880770311531 480,234.87402338574276 630,234.87402338574276" style="stroke-width: 140.40485554658898px;"><title>Run on 1st Down → Pass on 2nd Down
24</title></path><path class="link" d="M645,459.9124009635894C795,459.9124009635894 795,203.31966348370173 945,203.31966348370173" style="stroke-width: 123.09204598749412px;"><title>Run on 2nd Down → Pass on 3rd Down
21</title></path><path class="link" d="M330,268.53505611438277C480,268.53505611438277 480,459.68040351556135 630,459.68040351556135" style="stroke-width: 122.62805109143798px;"><title>Run on 1st Down → Run on 2nd Down
21</title></path><path class="link" d="M330,475.5681687501438C637.5,475.5681687501438 637.5,420.3942056637377 945,420.3942056637377" style="stroke-width: 90.86180052019428px;"><title>Pass on 1st Down → Other
16</title></path><path class="link" d="M330,384.99346507188426C480,384.99346507188426 480,350.2202545771996 630,350.2202545771996" style="stroke-width: 90.2876068363248px;"><title>Pass on 1st Down → Pass on 2nd Down
16</title></path><path class="link" d="M330,560.4995345051204C480,560.4995345051204 480,560.4948945561599 630,560.4948945561599" style="stroke-width: 79.00093098975911px;"><title>Pass on 1st Down → Run on 2nd Down
14</title></path><path class="link" d="M645,567.0766621567163C795,567.0766621567163 795,567.0766621567163 945,567.0766621567163" style="stroke-width: 65.84667568656744px;"><title>Run on 2nd Down → Run on 3rd Down
11</title></path><path class="link" d="M330,178.81613302253677C637.5,178.81613302253677 637.5,303.2705840235758 945,303.2705840235758" style="stroke-width: 56.809795092253985px;"><title>Run on 1st Down → Other
10</title></path><path class="link" d="M645,372.54971895309154C795,372.54971895309154 795,511.33666529668176 945,511.33666529668176" style="stroke-width: 45.633318033501624px;"><title>Pass on 2nd Down → Run on 3rd Down
8</title></path><path class="link" d="M645,328.0891480193718C795,328.0891480193718 795,353.3193934866717 945,353.3193934866717" style="stroke-width: 43.28782383393782px;"><title>Pass on 2nd Down → Other
7</title></path><path class="link" d="M645,527.8058741353844C795,527.8058741353844 795,472.17255610188295 945,472.17255610188295" style="stroke-width: 12.694900356096083px;"><title>Run on 2nd Down → Other
2</title></path></g><g><g class="node" transform="translate(0,20.00637992982086)"><rect height="579.9936200701792" width="15" style="fill: rgb(31, 119, 180); stroke: rgb(15, 58, 88);"><title>New Down
100</title></rect><text x="21" y="289.9968100350896" dy=".35em" text-anchor="start">New Down</text></g><g class="node" transform="translate(315,339.84966165372185)"><rect height="260.15033834627815" width="15" style="fill: rgb(174, 199, 232); stroke: rgb(85, 97, 113);"><title>Pass on 1st Down
45</title></rect><text x="21" y="130.07516917313907" dy=".35em" text-anchor="start">Pass on 1st Down</text></g><g class="node" transform="translate(315,10.006379929820824)"><rect height="319.84328172390104" width="15" style="fill: rgb(255, 127, 14); stroke: rgb(124, 62, 6);"><title>Run on 1st Down
55</title></rect><text x="21" y="159.92164086195052" dy=".35em" text-anchor="start">Run on 1st Down</text></g><g class="node" transform="translate(630,398.36637796984235)"><rect height="201.63362203015765" width="15" style="fill: rgb(255, 127, 14); stroke: rgb(124, 62, 6);"><title>Run on 2nd Down
35</title></rect><text x="-6" y="100.81681101507883" dy=".35em" text-anchor="end">Run on 2nd Down</text></g><g class="node" transform="translate(945,8.526512829121202e-14)"><rect height="264.8656864774487" width="15" style="fill: rgb(174, 199, 232); stroke: rgb(85, 97, 113);"><title>Pass on 3rd Down
46</title></rect><text x="-6" y="132.43284323872436" dy=".35em" text-anchor="end">Pass on 3rd Down</text></g><g class="node" transform="translate(945,488.52000627993095)"><rect height="111.47999372006907" width="15" style="fill: rgb(255, 127, 14); stroke: rgb(124, 62, 6);"><title>Run on 3rd Down
19</title></rect><text x="-6" y="55.73999686003454" dy=".35em" text-anchor="end">Run on 3rd Down</text></g><g class="node" transform="translate(630,164.67159561244827)"><rect height="230.69478235739408" width="15" style="fill: rgb(174, 199, 232); stroke: rgb(85, 97, 113);"><title>Pass on 2nd Down
40</title></rect><text x="-6" y="115.34739117869704" dy=".35em" text-anchor="end">Pass on 2nd Down</text></g><g class="node" transform="translate(945,274.8656864774488)"><rect height="203.6543198024822" width="15" style="fill: rgb(255, 187, 120); stroke: rgb(124, 91, 58);"><title>Other
35</title></rect><text x="-6" y="101.8271599012411" dy=".35em" text-anchor="end">Other</text></g></g></svg></div>  
    
    <!--Attribution:
Mike Bostock https://github.com/d3/d3-plugins/tree/master/sankey
Mike Bostock http://bost.ocks.org/mike/sankey/
-->

<script>
(function(){
var params = {
 "dom": "chart30dd7aa0a243",
"width":    960,
"height":    600,
"data": {
 "source": [ "New Down", "New Down", "Pass on 1st Down", "Pass on 1st Down", "Pass on 1st Down", "Run on 1st Down", "Run on 1st Down", "Run on 1st Down", "Pass on 2nd Down", "Pass on 2nd Down", "Pass on 2nd Down", "Run on 2nd Down", "Run on 2nd Down", "Run on 2nd Down" ],
"target": [ "Pass on 1st Down", "Run on 1st Down", "Pass on 2nd Down", "Run on 2nd Down", "Other", "Pass on 2nd Down", "Run on 2nd Down", "Other", "Pass on 3rd Down", "Run on 3rd Down", "Other", "Pass on 3rd Down", "Run on 3rd Down", "Other" ],
"value": [ 44.854, 55.146, 15.567, 13.621, 15.666, 24.208, 21.143, 9.7949, 24.444, 7.8679, 7.4635, 21.223, 11.353, 2.1888 ] 
},
"nodeWidth":     15,
"nodePadding":     10,
"layout":     32,
"id": "chart30dd7aa0a243" 
};

params.units ? units = " " + params.units : units = "";

//hard code these now but eventually make available
var formatNumber = d3.format("0,.0f"),    // zero decimal places
    format = function(d) { return formatNumber(d) + units; },
    color = d3.scale.category20();

if(params.labelFormat){
  formatNumber = d3.format(".2%");
}

var svg = d3.select('#' + params.id).append("svg")
    .attr("width", params.width)
    .attr("height", params.height);
    
var sankey = d3.sankey()
    .nodeWidth(params.nodeWidth)
    .nodePadding(params.nodePadding)
    .layout(params.layout)
    .size([params.width,params.height]);
    
var path = sankey.link();
    
var data = params.data,
    links = [],
    nodes = [];
    
//get all source and target into nodes
//will reduce to unique in the next step
//also get links in object form
data.source.forEach(function (d, i) {
    nodes.push({ "name": data.source[i] });
    nodes.push({ "name": data.target[i] });
    links.push({ "source": data.source[i], "target": data.target[i], "value": +data.value[i] });
}); 

//now get nodes based on links data
//thanks Mike Bostock https://groups.google.com/d/msg/d3-js/pl297cFtIQk/Eso4q_eBu1IJ
//this handy little function returns only the distinct / unique nodes
nodes = d3.keys(d3.nest()
                .key(function (d) { return d.name; })
                .map(nodes));

//it appears d3 with force layout wants a numeric source and target
//so loop through each link replacing the text with its index from node
links.forEach(function (d, i) {
    links[i].source = nodes.indexOf(links[i].source);
    links[i].target = nodes.indexOf(links[i].target);
});

//now loop through each nodes to make nodes an array of objects rather than an array of strings
nodes.forEach(function (d, i) {
    nodes[i] = { "name": d };
});

sankey
  .nodes(nodes)
  .links(links)
  .layout(params.layout);
  
var link = svg.append("g").selectAll(".link")
  .data(links)
.enter().append("path")
  .attr("class", "link")
  .attr("d", path)
  .style("stroke-width", function (d) { return Math.max(1, d.dy); })
  .sort(function (a, b) { return b.dy - a.dy; });

link.append("title")
  .text(function (d) { return d.source.name + " → " + d.target.name + "\n" + format(d.value); });

var node = svg.append("g").selectAll(".node")
  .data(nodes)
.enter().append("g")
  .attr("class", "node")
  .attr("transform", function (d) { return "translate(" + d.x + "," + d.y + ")"; })
.call(d3.behavior.drag()
  .origin(function (d) { return d; })
  .on("dragstart", function () { this.parentNode.appendChild(this); })
  .on("drag", dragmove));

node.append("rect")
  .attr("height", function (d) { return d.dy; })
  .attr("width", sankey.nodeWidth())
  .style("fill", function (d) { return d.color = color(d.name.replace(/ .*/, "")); })
  .style("stroke", function (d) { return d3.rgb(d.color).darker(2); })
.append("title")
  .text(function (d) { return d.name + "\n" + format(d.value); });

node.append("text")
  .attr("x", -6)
  .attr("y", function (d) { return d.dy / 2; })
  .attr("dy", ".35em")
  .attr("text-anchor", "end")
  .attr("transform", null)
  .text(function (d) { return d.name; })
.filter(function (d) { return d.x < params.width / 2; })
  .attr("x", 6 + sankey.nodeWidth())
  .attr("text-anchor", "start");

// the function for moving the nodes
  function dragmove(d) {
    d3.select(this).attr("transform", 
        "translate(" + (
                   d.x = Math.max(0, Math.min(params.width - d.dx, d3.event.x))
                ) + "," + (
                   d.y = Math.max(0, Math.min(params.height - d.dy, d3.event.y))
                ) + ")");
        sankey.relayout();
        link.attr("d", path);
  }
})();
</script>
    
  

</body></html>